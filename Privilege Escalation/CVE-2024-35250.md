# Rule : Potential CVE-2024-35250 Exploitation Activity

## Description
Detects potentially suspicious loading of "ksproxy.ax", which may indicate an attempt to exploit CVE-2024-35250.
This detection rule identifies potential exploitation attempts of (CVE-2024-35250) that could allow attackers to achieve privilege escalation. By abusing the image load mechanism, threat actors may attempt to load a malicious module in place of a legitimate one, bypassing security controls and escalating privileges on the target system.

- [Detection.fyi: Image Load Exploit CVE-2024-35250 Privilege Escalation](https://detection.fyi/sigmahq/sigma/emerging-threats/2024/exploits/cve-2024-35250/image_load_exploit_cve_2024_35250_privilege_escalation/)

## Detection Logic
- Monitors `DeviceImageLoadEvents`  events for ksproxy.ax being loaded by a suspicious process

## Tags
- Privilege Escalation
- Image Load Exploit
- CVE-2024-35250
- Exploitation
- Windows Security
- Suspicious Activity

## Search Query
```kql
DeviceImageLoadEvents
| where FileName endswith @"ksproxy.ax"
```


- **Exclusions:**
  you might need to excluded the following in your enviroment
  - Exclude events where the `FilenName` field starts with any of the following trusted system paths:
    - `C:\Program Files\`
    - `C:\Program Files (x86)\`
    - `C:\Windows\System32\`
    - `C:\Windows\SysWOW64\`
  - Exclude events where the `Image` field ends with any of the following known legitimate applications:
    - `\AppData\Local\Microsoft\Teams\current\Teams.exe`
    - `\AppData\Roaming\Zoom\bin\Zoom.exe`
    - `\AppData\Local\Mozilla Firefox\firefox.exe`
    - `\AppData\Local\Google\Chrome\Application\chrome.exe`
    - `\AppData\Local\Programs\Opera\opera.exe`
